---
description: 
globs: 
alwaysApply: true
---

# ProjectSetup:

An AlphaGo-inspired MCTS for the abstract strategy game 'WallWars'.

## Self-play (C++)

The ResNet model used for inference is compiled into an optimized form using TensorRT and self-play is done in C++.

The CMAKE setup is in [CMakeLists.txt](mdc:CMakeLists.txt) and [CMakePresets.json](mdc:CMakePresets.json).

Dependencies:
* folly (for coroutines, logging, thread pools, and more)
* CUDA & TensorRT (for inference)

Optional:
* Catch2 v3 (for unit tests)

## Training (Python)

A new model can be trained using `scripts/training.py` (by default it assumes you're executing it from the `scripts` folder as your working directory). It has relatively self-explanatory command line arguments.

Dependencies:
* PyTorch (for model creation) w/ onnx (for exporting)
* fastai  (for training)

# Environment setup:

OS Name: Microsoft Windows 11 Home
OS Version: 24H2 Build 26100
64-bit operating system, x64-based processor
Intel(R) UHD Graphics 770 with driver version 32.0.101.6129
NVIDIA GeForce RTX 4090 with driver version 572.61
13th Gen Intel(R) Core(TM) i9-13900K (3000 MHz max clock speed, 24 cores, 32 logical processors)
32GB DRAM

The project runs over WSL.
- Ubuntu WSL2 environment is already set up and running Ubuntu 24.04.2 LTS

Software:
- CUDA Toolkit 12.8.1 (Windows, x86_64) (installed in C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v12.8)
- vcpkg is at C:/dev/vcpkg
- TensorRT is at C:/dev/TensorRT-10.11.0.33
- I installed Visual Studio Community 2022 with Desktop development with C++
- PyTorch version: 2.7.0+cu128
- CUDA available: True
- CUDA version: 12.8
- cuDNN version: 90701
- Device count: 1
- Current device: 0
- Device name: NVIDIA GeForce RTX 4090
- Fastai version: 2.8.1
- Fastai using CUDA: True

I use:
- Cursor on Windows
- git bash terminal

 # Instructions:

To enter the Ubuntu WSL2 environment, run:
wsl -d Ubuntu

To activate the Python virtual environment, run:
source .venv/bin/activate

Create makefile with this command:
cmake -DCMAKE_PREFIX_PATH="~/deepwallwars_folly_deps/folly_build_scratch/installed/folly;~/deepwallwars_folly_deps/folly_build_scratch/installed/fmt-ay0yhNJPNTdY1lqD870fK2TOdV0tMIrf-S0qJs5-yLw;~/deepwallwars_folly_deps/folly_build_scratch/installed/glog-Or4_YcKCBYmwhzpCKzU3rxBin97HeIDv_8yQYRg7CTk" ..

Make with:
make -j$(nproc)

Run the game in interactive mode:
./deep_ww --interactive

